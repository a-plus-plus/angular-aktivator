
<h1>Surveys</h1>
<div ng-repeat="survey in surveys">
	<h3>Survey {{$index+1}}: <a href="#/answer/1">{{survey.title}}</a>, Status: {{survey.status}}</h3>
	<ul>
		<div ng-repeat="question in survey.questions">
			<li>Question {{$index+1}}: {{question.title}}</li>
			<ul>
				<div ng-repeat="option in question.options">
					<li>Option {{$index+1}}: {{option.value}}</li>
				</div>
			</ul>
		</div>
	</ul>
</div>


<h3>New survey</h3>
<div>
	<form ng-submit="addSurvey()" ng-init="sid = 0">
		<fieldset>
			<label for="survey_title">Title:</label>
			<input ng-model="survey.title" type="text" id="survey.title" />
			<label for="survey_status">Status:</label>
			<select ng-model="survey.status" id="survey_status">
				<option value="Published">Published</option>
				<option value="Unpublished">Unpublished</option>
				<option value="Finished">Finished</option>
			</select>			
		</fieldset>	
		<div ng-repeat="question in survey.questions" ng-init="outerIndex = $index" style="padding-left:50px">
			<fieldset id = "survey_question_{{outerIndex}}" ng-hide="question.destroy==1">
				<label for="question_title">Question</label><br />
				<textarea ng-model="question.title" id="survey_question_title_{{outerIndex}}"></textarea>
				<label for="question_kind">Kind</label><br />
				<select ng-model="question.kind" id="survey_question_kind_{{outerIndex}}">
					<option value="Radiobutton">Radiobutton</option>
					<option value="Checkbox">Checkbox</option>
					<option value="Textfield">Textfield</option>
				</select>
				<input type="hidden" value="{{question.id}}"/>
				<input type="hidden" value="{{question.destroy}}"><br />
				<button ng-click="newOption($event, question)">New Option</button>
				<button ng-click="removeQuestion(question, $event, outerIndex)">Remove question</button>
			</fieldset>
				<div ng-repeat="option in question.options" ng-init="innerIndex = $index" style="padding-left:50px">
					<fieldset id = "survey_option_{{innerIndex}}" ng-hide="option.destroy==1">
						<label for="option_value">Option</label><br />
						<textarea ng-model="option.value" id="survey_question_{{outerIndex}}_option_value_{{innerIndex}}'"></textarea>
						<button ng-click="removeOption(option, $event, innerIndex)">Remove option</button><br />
						<input type="hidden" value="{{option.id}}"/>
						<input type="hidden" value="{{option.destroy}}">        
					</fieldset>
				</div>
			</div>								

	</div>
	<div class="actions">
		<button ng-click="submit(survey)">Submit</button>
		<button ng-click="newQuestion($event)">New Question</button>
		{{survey}}
	</div>
</form>
</div>