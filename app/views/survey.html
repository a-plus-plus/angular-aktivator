
<h1>Surveys</h1>
<div ng-repeat="survey in surveys">
	<h3>Survey {{$index+1}}: <a ng-href="#/answer/{{survey.id}}">{{survey.title}}</a>, Status: {{survey.status}}</h3>
	<ul>
		<div ng-repeat="question in survey.questions" ng-init="index=$index+1">
			<li> {{question.title}}</li>
			<ul>
				<div ng-repeat="option in question.options" ng-init="index=$index+1">
					<li>{{index}}: {{option.value}}</li>
				</div>
			</ul>
		</div>
	</ul>
</div>


<h3>New survey</h3>
<div>
	<form ng-submit="addSurvey()">
		<fieldset>
			<label>Title:</label>
			<input ng-model="survey.title" type="text" />
			<label>Status:</label>
			<select ng-model="survey.status" id="survey_status" ng-init="survey.status='Unpublished'">
				<option value="Published">Published</option>
				<option value="Unpublished">Unpublished</option>
				<option value="Finished">Finished</option>
			</select>			
		
		<div ng-repeat="question in survey.questions" style="padding-left:50px">
			<fieldset ng-hide="question.destroy==1">
				<textarea ng-model="question.title" ></textarea>
				<button ng-click="removeQuestion(question, $event, $index, survey)" class="btn btn-small" style="float:right">
					<i  class="icon-minus-sign"/>
				</button>
				<label>Kind</label>
				<select ng-model="question.kind">
					<option value="Radiobutton">Radiobutton</option>
					<option value="Checkbox">Checkbox</option>
					<option value="Textfield">Textfield</option>
				</select>
				<br>
				
			
				<div ng-repeat="option in question.options" style="padding-left:50px">
					<fieldset ng-hide="option.destroy==1">
						<button ng-click="removeOption(option, $event, $index, question)" class="btn btn-small" style="float:right">
							<i class="icon-minus-sign" />
						</button>
						<label >Option</label><br />
						<textarea ng-model="option.value"></textarea>
						<input type="hidden" value="{{option.id}}"/>
						<input type="hidden" value="{{option.destroy}}">        
					</fieldset>
				</div>
				<button ng-click="newOption($event, question)" class="btn btn-small">
					<i class="icon-plus-sign"></i>
				</button>
				</fieldset>
			</div>	
			<br>
			<button ng-click="newQuestion($event)" class="btn btn-small">
			<i class="icon-plus-sign"></i>
		</button>							
		</fieldset>	
	</div>
	<div class="actions">
		<button ng-click="submit(survey)" class="btn ">Submit</button>
		{{survey}}
	</div>
</form>
</div>